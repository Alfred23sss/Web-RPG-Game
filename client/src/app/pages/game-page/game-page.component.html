<div class="game-container">
    <!-- Carte du jeu -->

    <!-- Panneau d'informations -->
    <div class="game-info">
        <div class="game-details">
            <h3>Informations de partie</h3>
            <p>Taille de la carte: {{ game?.size }}</p>
            <p>
                Joueurs actuels: @for(player of playerList; track $index){
                <span
                    class="player-name"
                    [class.player-admin]="player.isAdmin"
                    [class.player-regular]="!player.isAdmin"
                    [class.abandoned]="player.hasAbandoned"
                    [class.active]="player.isActive"
                >
                    {{ player.name }} Combat gagné: {{ player.combatWon }}
                </span>
                }
            </p>
            <p>Joueur actif: {{ lobby.players.length }}</p>
        </div>

        <div class="inventory">
            <h3>Inventaire</h3>
            <div class="inventory-slot" *ngFor="let slot of [0, 1]">(Vide)</div>
        </div>

        <div class="player-info">
            <h3>Informations du joueur</h3>
            <div class="player-header">
                <p class="player-name">{{ currentPlayer.name }}</p>
                <img [src]="currentPlayer.avatar" alt="Avatar du joueur" class="player-avatar" />
            </div>
            <div class="player-stats">
                <div class="health-bar">
                    <div class="health-label">Points de vie: {{ currentPlayer.hp.current }} / {{ currentPlayer.hp.max }}</div>
                    <div class="health-bar-outer">
                        <div class="health-bar-inner" [style.width.%]="(currentPlayer.hp.current / currentPlayer.hp.max) * 100"></div>
                    </div>
                </div>
                <div class="attributes-grid">
                    <div class="attribute">
                        <span class="attribute-label">Rapidité: </span>
                        <span class="attribute-value">{{ currentPlayer.speed }}</span>
                    </div>
                    <div class="attribute">
                        <span class="attribute-label">Attaque: </span>
                        <span class="attribute-value">{{ currentPlayer.attack }}</span>
                    </div>
                    <div class="attribute">
                        <span class="attribute-label">Défense: </span>
                        <span class="attribute-value">{{ currentPlayer.defense }}</span>
                    </div>
                </div>
                <div class="dice-type">
                    <span class="dice-label">Dés assignés: </span>
                    <span class="dice-value">{{ currentPlayer.attack.bonusDice }}</span>
                </div>
                <div class="resources">
                    <div class="resource">
                        <span class="resource-label">Mouvements restants: </span>
                        <span class="resource-value">{{ currentPlayer.movementPoints }}</span>
                    </div>
                    <div class="resource">
                        <span class="resource-label">Actions restantes: </span>
                        <span class="resource-value">{{ currentPlayer }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="game-map-container">
        <div class="game-map">
            <app-grid
                [grid]="game?.grid"
                [availablePath]="availablePath"
                [quickestPath]="quickestPath"
                [isEditionMode]="false"
                (tileHovered)="updateQuickestPath($event)"
            ></app-grid>
        </div>

        <div class="action-buttons">
            <button class="action-btn end-turn" (click)="endTurn()">Terminer tour</button>
            <button class="action-btn execute-action" (click)="executeNextAction()">Exécuter action</button>
            <button class="action-btn abandon-game" (click)="abandonGame()">Abandonner</button>
        </div>
    </div>

    <div class="game-messages">
        <h3>Messages</h3>

        <!-- Boutons pour basculer entre les panneaux -->
        <div class="message-toggle">
            <button [class.active]="activeTab === 'chat'" (click)="activeTab = 'chat'">Clavardage</button>
            <button [class.active]="activeTab === 'log'" (click)="activeTab = 'log'">Journal de bord</button>
        </div>

        <!-- Panneau des messages -->
        <div class="messages-content" *ngIf="activeTab === 'chat'">
            <p>Panneau des messages (clavardage).</p>
        </div>

        <!-- Panneau du journal de bord -->
        <div class="log-content" *ngIf="activeTab === 'log'">
            @for(entry of logEntries; track $index) {
            <p class="log-entry">
                {{ entry }}
            </p>
            }
        </div>
    </div>
    <!-- Compte à rebours 
    <div class="countdown">
        @if(Player.isInCombat)
        {
            <p>Temps restant: {{ game?.countdown }}</p>
        }
        @else
        {
            <p>Pas en combat</p>
        }

    </div>-->

    <!-- Interface de combat 
    <div class="combat-interface" *ngIf="player?.isInCombat">
        <h3>Combat</h3>
        <p>Résultats des dés: {{ game?.combatDiceResults }}</p>
        <p>Tentatives d'évasion restantes: {{ player?.escapeAttempts }}</p>
        <button (click)="attack()" *ngIf="game?.playerTurn === player">Attaquer</button>
        <button (click)="evade()" *ngIf="player?.escapeAttempts > 0">Évasion</button>
    </div>-->
</div>
