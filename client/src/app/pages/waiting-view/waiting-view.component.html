<div class="waiting-view">
    @if (isLoading) {
    <p>Chargement en cours...</p>
    } @else {
    <p>En attente de participants...</p>

    @if (lobby) {
    <p>
        Votre code d'accès: <strong>{{ lobby.accessCode }}</strong>
    </p>

    <div class="waiting-line">
        <h2>Liste des joueurs en attente</h2>
        <ul>
            @for (player of lobby.players; track $index) {
            <li>
                <div class="player-info">
                    <img [src]="player.avatar" alt="Avatar" class="player-avatar" />
                    @if (player.isVirtual) {
                    <span class="virtual-player-name player-name">{{ player.name }}</span>
                    } @else if (player.name === this.player?.name) {
                    <span class="yellow-tag player-name">{{ player.name }}</span>
                    } @else {
                    <span class="player-name">{{ player.name }}</span>
                    }
                </div>
                <div class="player-actions">
                    @if (player.isAdmin) {
                    <span class="admin-badge">Admin</span>
                    } @if (player.isVirtual) {
                    <span class="virtual-badge">Virtuel</span>
                    } @if (player && this.player?.isAdmin && !player.isAdmin) {
                    <button class="kick-button" (click)="player.isVirtual ? kickVirtualPlayer(player) : kickPlayer(player)">Expulser</button>
                    }
                </div>
            </li>
            }
        </ul>
    </div>

    <button class="button" (click)="navigateToHome()">Quitter</button>

    @if (player?.isAdmin) {
    <button class="button" (click)="navigateToGame()">Commencer la partie</button>
    <button class="button" (click)="changeLobbyLockStatus()">
        {{ lobby.isLocked ? 'Déverrouiller' : 'Verrouiller' }}
    </button>

    <button class="button create-virtual-button" (click)="createVirtualPlayer()" [disabled]="lobby.isLocked" [class.disabled]="lobby.isLocked">
        Create Virtual Player
    </button>

    @if (isDialogOpen) {
    <div class="backdrop"></div>
    <div class="behavior-dialog">
        <h3>Choisi le comportement du joueur virtuel</h3>

        @for (behavior of behaviors; track $index) {
        <button class="button-behavior" (click)="setBehavior(behavior)">
            {{ behavior }}
        </button>
        }
        <button class="button-behavior" (click)="cancelVirtualPlayer()">Annuler</button>
    </div>
    }} } }
</div>

<div class="game-messages">
    <h3>Messages</h3>
    <div class="messages-content">
        <p>Panneau des messages (clavardage).</p>
    </div>
    <button class="message-btn">Envoyer</button>
</div>
